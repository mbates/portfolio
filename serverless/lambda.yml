service: bates-portfolio-send
provider:
  name: aws
  runtime: nodejs22.x
  stage: api
  region: us-east-1
  iamRoleStatements:
    - Effect: Allow
      Action:
        - ses:SendEmail
      Resource: '*'
  apiGateway:
    restApiId:
      'Fn::ImportValue': BSPortfolioGW-restApiId
    restApiRootResourceId:
      'Fn::ImportValue': BSPortfolioGW-rootResourceId
functions:
  send-email:
    handler: email.handler
    timeout: 10
    memorySize: 128
    environment:
      RECIPIENT_EMAIL: mbates@bates-solutions.com
      SENDER_EMAIL: portfolio@bates-solutions.com
      CORS_ORIGIN: https://bates-solutions.com
    events:
      - http:
          path: portfolio-message
          method: post
          cors:
            origin: 'https://bates-solutions.com'
            headers:
              - Content-Type
            allowCredentials: false
